<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ki·ªÉm Tra To√°n 10</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script>
    MathJax = {
        tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
        svg: { fontCache: 'global' }
    };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body { background: #f0f2f5; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .quiz-card { background: white; border-radius: 12px; padding: 25px; margin-bottom: 25px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .q-header { border-left: 5px solid #0d6efd; padding-left: 15px; margin-bottom: 20px; }
        .q-title { font-weight: 700; color: #2c3e50; font-size: 1.1rem; }
        .btn-option { width: 100%; text-align: left; margin: 5px 0; padding: 12px; border: 1px solid #dee2e6; border-radius: 8px; transition: 0.2s; background: white; }
        .btn-option:hover { background: #f8f9fa; border-color: #adb5bd; }
        .btn-option.selected { background: #e7f1ff; border-color: #0d6efd; color: #0d6efd; font-weight: bold; }
        .solution-area { display: none; margin-top: 15px; padding: 20px; background: #e8f5e9; border-radius: 8px; border: 1px dashed #198754; }
        img { max-width: 100%; height: auto; border-radius: 5px; margin: 10px 0; display: block; }
    </style>
</head>
<body>
<div class="container py-5" style="max-width: 800px;">
    <h1 class="text-center mb-5 fw-bold text-primary">ƒê·ªÄ KI·ªÇM TRA TO√ÅN</h1>
    <div id="loading" class="text-center text-muted">ƒêang t·∫£i d·ªØ li·ªáu...</div>
    <div id="quiz-container"></div>
</div>

<script>
    // 1. C·∫•u h√¨nh file
    const FILE_MD = 'ketqua.md';

    // 2. H√†m x·ª≠ l√Ω Markdown sang HTML (Chuy·ªÉn ·∫£nh v√† c√¥ng th·ª©c)
    function cleanMarkdown(text) {
        // Chuy·ªÉn c√∫ ph√°p ·∫£nh pandoc ![](path) th√†nh th·∫ª <img>
        text = text.replace(/!\[(.*?)\]\((.*?)\)/g, '<img src="$2" alt="$1">');
        return text;
    }

    // 3. Logic ch√≠nh
    async function loadQuiz() {
        try {
            const res = await fetch(FILE_MD);
            if (!res.ok) throw new Error('Kh√¥ng ƒë·ªçc ƒë∆∞·ª£c file ƒë·ªÅ thi (L·ªói ' + res.status + ')');
            const text = await res.text();
            
            // T√°ch c√¢u h·ªèi d·ª±a v√†o regex "C√¢u X" ho·∫∑c "B√†i X"
            // L∆∞u √Ω: Regex n√†y ph·ª• thu·ªôc v√†o format file Word c·ªßa b·∫°n
            const rawQuestions = text.split(/(?:^|\n)(?=#{1,3}\s+(?:C√¢u|B√†i)\s+\d+)/i).slice(1);
            
            const container = document.getElementById('quiz-container');
            document.getElementById('loading').style.display = 'none';

            rawQuestions.forEach((qText, index) => {
                const lines = qText.trim().split('\n');
                let title = lines[0].replace(/#{1,3}/g, '').trim(); // L·∫•y d√≤ng ti√™u ƒë·ªÅ (b·ªè d·∫•u #)
                let content = "";
                let options = [];
                let solution = "";
                let isSolution = false;

                // Ph√¢n t√≠ch t·ª´ng d√≤ng
                for (let i = 1; i < lines.length; i++) {
                    let line = lines[i].trim();
                    if (!line) continue;

                    // Nh·∫≠n di·ªán L·ªùi gi·∫£i
                    if (line.match(/^L·ªùi gi·∫£i/i) || line.match(/^H∆∞·ªõng d·∫´n/i)) {
                        isSolution = true;
                        continue; 
                    }

                    // Nh·∫≠n di·ªán ƒê√°p √°n A. B. C. D.
                    if (!isSolution && line.match(/^[A-D]\./)) {
                        options.push(cleanMarkdown(line));
                    } 
                    // N·ªôi dung kh√°c
                    else {
                        if (isSolution) solution += cleanMarkdown(line) + "<br>";
                        else content += cleanMarkdown(line) + "<br>";
                    }
                }

                // Render HTML
                const card = document.createElement('div');
                card.className = 'quiz-card';
                card.innerHTML = `
                    <div class="q-header">
                        <div class="q-title">${title}</div>
                        <div class="mt-2">${content}</div>
                    </div>
                    <div class="row">
                        ${options.map(opt => {
                            let label = opt.substring(0, 2); // A.
                            let val = opt.substring(2);
                            return `<div class="col-md-6"><button class="btn-option" onclick="showSol(this, ${index})"><strong>${label}</strong> ${val}</button></div>`
                        }).join('')}
                    </div>
                    <div id="sol-${index}" class="solution-area">
                        <strong>üí° H∆∞·ªõng d·∫´n gi·∫£i:</strong><br>${solution || 'Kh√¥ng c√≥ l·ªùi gi·∫£i chi ti·∫øt.'}
                    </div>
                `;
                container.appendChild(card);
            });
            MathJax.typeset(); // V·∫Ω l·∫°i c√¥ng th·ª©c to√°n
        } catch (err) {
            document.getElementById('loading').innerHTML = `
                <div class="alert alert-warning">
                    <strong>Ch∆∞a xem ƒë∆∞·ª£c ngay ƒë√¢u!</strong><br>
                    Tr√¨nh duy·ªát ch·∫∑n ƒë·ªçc file t·ª´ ·ªï c·ª©ng.<br>
                    üëâ B·∫°n h√£y upload c·∫£ th∆∞ m·ª•c n√†y l√™n GitHub Pages ƒë·ªÉ ch·∫°y nh√©.
                </div>`;
        }
    }
    loadQuiz();

    function showSol(btn, id) {
        // Hi·ªáu ·ª©ng ch·ªçn
        let parent = btn.closest('.row');
        parent.querySelectorAll('.btn-option').forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
        // Hi·ªán l·ªùi gi·∫£i
        document.getElementById(`sol-${id}`).style.display = 'block';
    }
</script>
</body>
</html>